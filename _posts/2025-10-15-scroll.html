---
---

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Linked Pages Side by Side with Variables</title>
<style>
body {
  margin: 0;
  display: flex;
  height: 100vh;
  overflow: hidden;
}
iframe {
  width: 50%;
  height: 100%;
  border: none;
}
#left { border-right: 1px solid #ccc; }
</style>
</head>
<body>



<script>
// Variables for the pages
//const leftPage = "{% link _posts/2025-10-11-welcome-to-jekyll.markdown %}";
// const rightPage = "{% link _posts/2025-10-11-goodbye-to-jekyll.markdown %}";

// Get the current URL's query parameters
const params = new URLSearchParams(window.location.search);
numberSplits = params.get('split');

if(numberSplits === null) numberSplits = 2;
console.log(numberSplits);

const StartPage = "{% link index.markdown %}";
const iframesList = []
let listener = null;
let loaded = new Array(numberSplits).fill(false);

// Add all of the iframes to the body
for(let i = 0; i < numberSplits; i++){
  const iframe = document.createElement("iframe");
  iframe.id = `iframe${i}`;
  // Wait for all the iframes to load
  iframe.addEventListener('load',() => {
    loaded[i] = true;
    console.log(iframe.contentWindow.location.href);
    if(loaded.every(value => value === true)) initialize(iframesList);
  });
  iframe.src = StartPage;
  iframesList.push(iframe);
  document.body.appendChild(iframe);
}

function addIntercept(iframesList){
  // Listener to scroll all iframes into view
  const listener = e => {
    const a = e.target.closest('a');
    if(!a) return;

    const href = a.getAttribute('href');
    if(!href) return;

    // Get the hash from the href's url
    const parts = href.split('#');
    const hash = parts.length > 1 ? '#' + parts[1] : ''; 

    if(hash){
      iframesList.forEach(iframe => {
        const targetDoc = iframe.contentWindow.document;
        const target = targetDoc.getElementById(hash.slice(1));

        if(target){
          e.preventDefault();
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          // trigger :target animation by changing hash

          // Use dummy to not temporarily go to the beggining of the webpage!
          iframe.contentWindow.location.hash = "#dummy";
          // Force a slight delay to let browser repaint
          setTimeout(() => {
            iframe.contentWindow.location.hash = hash;
          }, 0);
        }
      });
    }
  }
  
  iframesList.forEach(iframe => {
    iframe.contentWindow.document.addEventListener('click',listener);
  });
  return listener;
}

function removeListeners(iframesList,listener){
  iframesList.forEach(iframe => {
    iframe.contentWindow.document.removeEventListener('click',listener);
  });
}

function initialize(iframesList){
  if(listener) removeListeners(iframesList,listener);
  listener = addIntercept(iframesList);
}

</script>
</body>
</html>

